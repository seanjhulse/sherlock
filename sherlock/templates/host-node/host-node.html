<!doctype html>

<html>

<head>
    <title>Host Page</title>
    <script src="https://unpkg.com/cytoscape/dist/cytoscape.umd.js"></script>
	{% load static %}
	<link rel="stylesheet" href="{% static 'css/styles.css' %}" />
</head>

<style>
    #cy {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0px;
        left: 0px;
        background-color: #141414;
    }
</style>

<body>
	<!-- Navigation Bar -->
	  <nav class="navbar">
		<div class="navbar__container">
		  <a href="/" id="navbar__logo"
			><img
			  width="75"
			  height="75"
			  src="{% static 'images/SherLOCK - App Logo.png' %}"
			/>SherLOCK</a
		  >
  
		  <!-- Hamburger Button -->
		  <div class="navbar__toggle" id="mobile-menu">
			<span class="bar"></span>
			<span class="bar"></span>
			<span class="bar"></span>
		  </div>
  
		  <!--Top Navbar Items-->
		  <ul class="navbar__menu">
			<!--Home Button-->
			<li class="navbar__item">
			  <a href="/" class="navbar__links"> Home </a>
			</li>

		  </ul>
		</div>
	  </nav>

	  <!-- Main Section -->
	  <div class="main">
		<div class="main__container">
		  <div class="main__content">
			
		  </div>
		</div>
		<!--End Of 'main_container'-->
	  </div>
	  <!--End Of 'main'-->
	
    <div id="cy"></div>
    <script>
        
        
        /* first, create home node with appropriate labels using spread notation
            then, loop through open ports and do the same for them
            
            add style element with spread notation, also looping through ports
            
            finally, create nodes with .add() and organize concentric. possibly just add nodes too.
        */    
        
        _hostAddress = "192.168.1.5";
        _hostOS = "Windows 10";
        _ports = [80, 443, 632, 663, 500, 3600];
        
        _nodeColor = '#F9F9F9';
        
        
        //initialize object for cytoscape
        var hostJSON = {container: document.getElementById('cy'),}
        
        //create and append nodes under list 'element'
        
        var _elements = [{ data: { id: "host"}  },];
        
        for (var i = 0; i < _ports.length; i++){
            _elements.push({ data: { id: 'port' + _ports[i]}  });
        }
        
        hostJSON = {...hostJSON,
			elements: _elements
                   }
        
        //create and append style objects under list 'style'
        
        var _osIcon;
        var _portIcon = "../../static/images/port-icon.png";
        
        switch (_hostOS){

        	case "Windows 10":
        	        _osIcon = "../../static/images/windows-10-icon.png";
			break;
		case "iOs":
        	        _osIcon = "../../static/images/ios-icon.png";
			break;
		case "Linux":
	                _osIcon = "../../static/images/linux-icon.png";
			break;		
		case "Android":
	                _osIcon = "../../static/images/android-icon.png";
			break;			
		case "Chrome OS":
	                _osIcon = "../../static/images/chrome-os-icon.png";
			break;	
            	default:
                	_osIcon =  "../../static/images/default-logo.png";
	}
        

        var _style = [{
				selector: '#host', //#tag name to select node
				style: {
					shape: 'roundrectangle',
					width: 128,
					height:128,
					'background-image' : _osIcon,
                    'background-color' : _nodeColor,
					label: _hostAddress,
                    'color': _nodeColor,
				},
			}];

        
        for (var i = 0; i < _ports.length; i++){
            _style.push({
				selector: '#port'+_ports[i],
				style: {
					shape: 'roundrectangle',
					width: 85,
					height: 85,
					'background-image' : _portIcon,
                    'background-color' : _nodeColor,
					label: "port " + _ports[i],
                    'color': _nodeColor,
				}
            });
        }
        
        hostJSON = {...hostJSON,
			style: _style,
        }
	   	
        //RUN CYTOSCAPE
        var cy = cytoscape(hostJSON);
        
        
        //Connect nodes to host using .add(). may move node creation up to the initial
        //object creation later, but for now will just use this
        //need to figure out how to make nodes longer
      
        for (var i = 0; i < _ports.length; i++){
            
            var source = 'port' + _ports[i];
            cy.add({
                data: {
                    id: 'edge' + i,
                    source: source,
                    target: 'host',
                },
	        });
        }
        
        
        //run .layout() to organize nodes.        
	    
        cy.layout({
		    name: 'concentric',
			minDist: 40			
		}).run();
    
    </script>
</body>
</html>
